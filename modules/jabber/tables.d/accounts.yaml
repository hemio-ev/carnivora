name: accounts
description: Jabber accounts
primary_key:
 - node
 - domain

foreign_keys:
 -
  name: ensure domain has a correspoding rr
  columns:
   - domain
   - rr_type
  ref_table: dns.name_host
  ref_columns:
   - name
   - type

columns:
 -
  tag: column
  name: node
  type: varchar(255)
  description: part in front of the @ in account name
 -
  tag: column
  name: domain
  description: part behind @
  type: dns.domain_name
 -
  tag: column
  name: rr_type
  description: Allowed resource record type, for FK with dns.name_host
  type: dns.type
  default: "'SRV'"
 -
  tag: column_tpl
  template: commons.password
 -
  tag: column_tpl
  template: backend.job
 -
  tag: column_tpl
  template: user.owner

checks:
 -
  name: rr_type alyways SRV
  description: see name
  check: rr_type = 'SRV'
