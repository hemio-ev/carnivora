name: user
description: |
 Carnivora Users: Users own things objects in the DB,
 and they can login into frontends (edentata)

column_templates:
 -
  template: owner
  name: owner
  type: user.t_user
  description: for ownage
  references: user.user.name

roles:
 -
  name: userlogin
  description: Do user actions via this group
  login: false

function_templates:
 -
  template: userlogin
  description: complicated...
  priv_execute: 
   - userlogin

  variables:
   -
    name: v_owner
    type: commons.t_key

  body_prelude: |
   -- begin userlogin prelude
   v_owner := (SELECT "name" FROM "user"._get_login());
   -- end userlogin prelude
   
table_templates:
 -
  template: ownable
  description: For tables in which rows can be owned by users.
  
  columns:
   -
    template: user.owner

domains:
 -
  name: t_user
  type: commons.t_key
  description: Username
  