name: backend
description: |
 Carnivora Backend:
 The backend module provides everything required for the backend API.
 The backend API delivers content required for building configs etc.
 to clients, called machines.

domains:
 -
  name: t_status
  description: Backend status
  type: VARCHAR(20)

column_templates:
 -
  template: job
  name: backend_status
  description: |
      Status of database entry in backend. NULL: nothing pending,
      new: entry not present on backend client, upd: update
      pending on backend client, del: deletion peding on
      backend client.    
  type: backend.t_status
  default: "'ins'"
  null: true

function_templates:
 -
  template: backend
  description: |
      Tries to identify if connected role has the right to perform
      backend tasks for some machine. If this is the case, it
      identifies the machine. Otherwise it rises an exception.
  variables:
   -
    name: v_machine
    type: dns.t_domain
  
  body_prelude: |
   v_machine := (SELECT "machine" FROM "backend"._get_login());

table_templates:
 -
  template: status
  description: Backend
  columns:
   -
    template: backend.job
      