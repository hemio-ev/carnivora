name: dns
description: dns

exec_post_install: |
 SELECT * FROM dns.raw

domains:
 -
  name: domain_name
  description: Domain name
  type: varchar(253)
  checks:
   -
    name: check domain validity
    description: check domain validity
    check: domain_name_is_valid(VALUE)
 -
  name: type
  description: Resource record type
  type: varchar(253)
  checks:
   - 
    name: resource type
    description: check
    check: "VALUE IN ('MX', 'A', 'AAAA', 'CNAME', 'SRV')"
 -
  name: rdata
  description: record entry
  type: varchar

column_templates:
 -
  template: name
  name: domain
  type: dns.domain_name
  description: Name like sub.example.org. This defines to which name the resource record pertains.
 -
  template: type
  name: type
  type: dns.type
  description: Type (?) like MX, A, AAAA, ...
 -
  template: rdata
  name: rdata
  type: varchar
  description: fancy rdata storage
 -
  template: ttl
  description: Time to live
  name: ttl
  type: integer
  checks:
   -
    name: ttl range
    description: Ensure that TTL is positive and put maximum to 48h
    check: VALUE >= 0 AND VALUE <= 172800

table_templates:
 -
  template: reference_service
  description: Reference service
  columns:
   -
    name: domain
    type: dns.domain_name
    description: Domain name
  foreign_keys:
   -
    name: reference dns (service)
    columns:
     - domain
     - service
    ref_table: dns.service
    ref_columns:
     - domain
     - service

 -
  template: name
  description: Name
  columns:
   -
    tag: column_tpl
    template: dns.name
   -
    tag: column_tpl
    template: dns.type
