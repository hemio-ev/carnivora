name: email
description: E-Mail System
dependencies: [ domains ]

column_templates:
 -
  template: local_part
  name: local_part
  type: email.local_part
  description: Local part of the address
 -
  template: domain
  name: domain
  type: uuid
  references: dns.name_host.id
  description: Domain part of the address

domains:
 -
  name: local_part
  description: Local part of an e-mail address, the thing in front of the @
  type: varchar(64)
  
  checks:
   -
    name: valid_characters
    description: a
    check: "VALUE ~ '[A-Za-z0-9.]'"
    #check: "regexp_matches(VALUE, '[A-Za-z0-9.!#$%&'*+-/=?^_`{|}~]+')"
   -
    name: no_starting_dot
    description: b
    check: left(VALUE, 1) <> '.'
   -
    name: no_ending_dot
    description: c
    check: right(VALUE, 1) <> '.'

